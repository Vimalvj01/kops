--- FAIL: TestPrivateWeave (0.88s)
	integration_test.go:181: diff:
		+ resource "aws_autoscaling_attachment" "bastions-bastions-privateweave-example-com" {
		- resource "aws_autoscaling_attachment" "bastion-privateweave-example-com" {
		    elb = "${aws_elb.bastion-privateweave-example-com.id}"
		+   autoscaling_group_name = "${aws_autoscaling_group.bastions-bastions-privateweave-example-com.id}"
		-   autoscaling_group_name = "${aws_autoscaling_group.bastion-privateweave-example-com.id}"
		  }
		  
		...
		  }
		  
		+ resource "aws_autoscaling_group" "bastions-bastions-privateweave-example-com" {
		- resource "aws_autoscaling_group" "bastion-privateweave-example-com" {
		+   name = "bastions.bastions.privateweave.example.com"
		-   name = "bastion.privateweave.example.com"
		+   launch_configuration = "${aws_launch_configuration.bastions-bastions-privateweave-example-com.id}"
		-   launch_configuration = "${aws_launch_configuration.bastion-privateweave-example-com.id}"
		    max_size = 1
		    min_size = 1
		+   vpc_zone_identifier = ["${aws_subnet.utility-us-test-1a-privateweave-example-com.id}"]
		-   vpc_zone_identifier = ["${aws_subnet.private-us-test-1a-privateweave-example-com.id}"]
		    tag = {
		      key = "KubernetesCluster"
		...
		    tag = {
		      key = "Name"
		+     value = "bastions.bastions.privateweave.example.com"
		-     value = "bastion.privateweave.example.com"
		      propagate_at_launch = true
		    }
		+   tag = {
		+     key = "k8s.io/role/bastion"
		+     value = "1"
		+     propagate_at_launch = true
		+   }
		  }
		  
		...
		    max_size = 1
		    min_size = 1
		+   vpc_zone_identifier = ["${aws_subnet.us-test-1a-privateweave-example-com.id}"]
		-   vpc_zone_identifier = ["${aws_subnet.private-us-test-1a-privateweave-example-com.id}"]
		    tag = {
		      key = "KubernetesCluster"
		...
		    max_size = 2
		    min_size = 2
		+   vpc_zone_identifier = ["${aws_subnet.us-test-1a-privateweave-example-com.id}"]
		-   vpc_zone_identifier = ["${aws_subnet.private-us-test-1a-privateweave-example-com.id}"]
		    tag = {
		      key = "KubernetesCluster"
		...
		    security_groups = ["${aws_security_group.bastion-elb-privateweave-example-com.id}"]
		    subnets = ["${aws_subnet.utility-us-test-1a-privateweave-example-com.id}"]
		+   health_check = {
		+     target = "TCP:22"
		+     healthy_threshold = 2
		+     unhealthy_threshold = 2
		+     interval = 10
		+     timeout = 5
		+   }
		+   idle_timeout = 120
		+ }
		+ 
		+ resource "aws_iam_instance_profile" "bastions-privateweave-example-com" {
		+   name = "bastions.privateweave.example.com"
		+   roles = ["${aws_iam_role.bastions-privateweave-example-com.name}"]
		-   idle_timeout = 120
		  }
		  
		...
		  }
		  
		+ resource "aws_iam_role" "bastions-privateweave-example-com" {
		+   name = "bastions.privateweave.example.com"
		+   assume_role_policy = "${file("${path.module}/data/aws_iam_role_bastions.privateweave.example.com_policy")}"
		+ }
		+ 
		  resource "aws_iam_role" "masters-privateweave-example-com" {
		    name = "masters.privateweave.example.com"
		...
		  }
		  
		+ resource "aws_iam_role_policy" "bastions-privateweave-example-com" {
		+   name = "bastions.privateweave.example.com"
		+   role = "${aws_iam_role.bastions-privateweave-example-com.name}"
		+   policy = "${file("${path.module}/data/aws_iam_role_policy_bastions.privateweave.example.com_policy")}"
		+ }
		+ 
		  resource "aws_iam_role_policy" "masters-privateweave-example-com" {
		    name = "masters.privateweave.example.com"
		...
		  }
		  
		+ resource "aws_launch_configuration" "bastions-bastions-privateweave-example-com" {
		- resource "aws_launch_configuration" "bastion-privateweave-example-com" {
		+   name_prefix = "bastions.bastions.privateweave.example.com-"
		-   name_prefix = "bastion.privateweave.example.com-"
		    image_id = "ami-12345678"
		+   instance_type = "t2.micro"
		-   instance_type = "t2.medium"
		    key_name = "${aws_key_pair.kubernetes-privateweave-example-com-c4a6ed9aa889b9e2c39cd663eb9c7157.id}"
		+   iam_instance_profile = "${aws_iam_instance_profile.bastions-privateweave-example-com.id}"
		-   iam_instance_profile = "${aws_iam_instance_profile.masters-privateweave-example-com.id}"
		+   security_groups = ["${aws_security_group.bastions-privateweave-example-com.id}"]
		-   security_groups = ["${aws_security_group.bastion-privateweave-example-com.id}"]
		    associate_public_ip_address = false
		    root_block_device = {
		...
		  }
		  
		+ resource "aws_route" "0-0-0-0--0" {
		- resource "aws_route" "private-us-test-1a-privateweave-example-com" {
		+   route_table_id = "${aws_route_table.privateweave-example-com.id}"
		-   route_table_id = "${aws_route_table.private-us-test-1a-privateweave-example-com.id}"
		    destination_cidr_block = "0.0.0.0/0"
		+   gateway_id = "${aws_internet_gateway.privateweave-example-com.id}"
		-   nat_gateway_id = "${aws_nat_gateway.us-test-1a-privateweave-example-com.id}"
		  }
		  
		+ resource "aws_route" "private-us-test-1a-0-0-0-0--0" {
		- resource "aws_route" "wan" {
		+   route_table_id = "${aws_route_table.private-us-test-1a-privateweave-example-com.id}"
		-   route_table_id = "${aws_route_table.main-privateweave-example-com.id}"
		    destination_cidr_block = "0.0.0.0/0"
		+   nat_gateway_id = "${aws_nat_gateway.us-test-1a-privateweave-example-com.id}"
		-   gateway_id = "${aws_internet_gateway.privateweave-example-com.id}"
		  }
		  
		...
		  }
		  
		+ resource "aws_route_table" "private-us-test-1a-privateweave-example-com" {
		- resource "aws_route_table" "main-privateweave-example-com" {
		    vpc_id = "${aws_vpc.privateweave-example-com.id}"
		    tags = {
		      KubernetesCluster = "privateweave.example.com"
		+     Name = "private-us-test-1a.privateweave.example.com"
		-     Name = "main-privateweave.example.com"
		    }
		  }
		  
		+ resource "aws_route_table" "privateweave-example-com" {
		- resource "aws_route_table" "private-us-test-1a-privateweave-example-com" {
		    vpc_id = "${aws_vpc.privateweave-example-com.id}"
		    tags = {
		      KubernetesCluster = "privateweave.example.com"
		+     Name = "privateweave.example.com"
		-     Name = "private-us-test-1a.privateweave.example.com"
		    }
		  }
		  
		+ resource "aws_route_table_association" "private-us-test-1a-privateweave-example-com" {
		- resource "aws_route_table_association" "main-us-test-1a-privateweave-example-com" {
		+   subnet_id = "${aws_subnet.us-test-1a-privateweave-example-com.id}"
		-   subnet_id = "${aws_subnet.utility-us-test-1a-privateweave-example-com.id}"
		+   route_table_id = "${aws_route_table.private-us-test-1a-privateweave-example-com.id}"
		-   route_table_id = "${aws_route_table.main-privateweave-example-com.id}"
		  }
		  
		+ resource "aws_route_table_association" "utility-us-test-1a-privateweave-example-com" {
		- resource "aws_route_table_association" "private-us-test-1a-privateweave-example-com" {
		+   subnet_id = "${aws_subnet.utility-us-test-1a-privateweave-example-com.id}"
		-   subnet_id = "${aws_subnet.private-us-test-1a-privateweave-example-com.id}"
		+   route_table_id = "${aws_route_table.privateweave-example-com.id}"
		-   route_table_id = "${aws_route_table.private-us-test-1a-privateweave-example-com.id}"
		  }
		  
		...
		    name = "api-elb.privateweave.example.com"
		    vpc_id = "${aws_vpc.privateweave-example-com.id}"
		+   description = "Security group for ELB in front of API"
		-   description = "Security group for api ELB"
		    tags = {
		      KubernetesCluster = "privateweave.example.com"
		...
		  }
		  
		+ resource "aws_security_group" "bastions-privateweave-example-com" {
		- resource "aws_security_group" "bastion-privateweave-example-com" {
		+   name = "bastions.privateweave.example.com"
		-   name = "bastion.privateweave.example.com"
		    vpc_id = "${aws_vpc.privateweave-example-com.id}"
		+   description = "Security group for bastions"
		-   description = "Security group for bastion"
		    tags = {
		      KubernetesCluster = "privateweave.example.com"
		+     Name = "bastions.privateweave.example.com"
		-     Name = "bastion.privateweave.example.com"
		    }
		  }
		...
		  resource "aws_security_group_rule" "all-bastion-to-master" {
		    type = "ingress"
		+   security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		+   source_security_group_id = "${aws_security_group.bastions-privateweave-example-com.id}"
		-   source_security_group_id = "${aws_security_group.bastion-privateweave-example-com.id}"
		    from_port = 0
		    to_port = 0
		...
		  }
		  
		+ resource "aws_security_group_rule" "all-bastion-to-node" {
		- resource "aws_security_group_rule" "all-master-to-master" {
		    type = "ingress"
		+   security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		+   source_security_group_id = "${aws_security_group.bastions-privateweave-example-com.id}"
		+   from_port = 0
		+   to_port = 0
		+   protocol = "-1"
		+ }
		+ 
		+ resource "aws_security_group_rule" "all-master-to-master" {
		+   type = "ingress"
		+   security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		+   source_security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		-   source_security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		    from_port = 0
		    to_port = 0
		...
		  resource "aws_security_group_rule" "all-node-to-master" {
		    type = "ingress"
		-   security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		-   source_security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		-   from_port = 0
		-   to_port = 0
		-   protocol = "-1"
		- }
		- 
		- resource "aws_security_group_rule" "all-node-to-node" {
		-   type = "ingress"
		+   security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		    source_security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		    from_port = 0
		...
		  }
		  
		+ resource "aws_security_group_rule" "all-node-to-node" {
		- resource "aws_security_group_rule" "api-elb-egress" {
		+   type = "ingress"
		-   type = "egress"
		+   security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.api-elb-privateweave-example-com.id}"
		-   from_port = 0
		-   to_port = 0
		-   protocol = "-1"
		-   cidr_blocks = ["0.0.0.0/0"]
		- }
		- 
		- resource "aws_security_group_rule" "bastion-egress" {
		-   type = "egress"
		+   source_security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.nodes-privateweave-example-com.id}"
		    from_port = 0
		    to_port = 0
		    protocol = "-1"
		-   cidr_blocks = ["0.0.0.0/0"]
		  }
		  
		+ resource "aws_security_group_rule" "api-elb-egress" {
		- resource "aws_security_group_rule" "bastion-elb-egress" {
		    type = "egress"
		+   security_group_id = "${aws_security_group.api-elb-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.bastion-elb-privateweave-example-com.id}"
		    from_port = 0
		    to_port = 0
		...
		  }
		  
		+ resource "aws_security_group_rule" "bastion-egress" {
		- resource "aws_security_group_rule" "bastion-to-master" {
		-   type = "ingress"
		-   security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		+   type = "egress"
		+   security_group_id = "${aws_security_group.bastions-privateweave-example-com.id}"
		-   source_security_group_id = "${aws_security_group.bastion-privateweave-example-com.id}"
		    from_port = 0
		    to_port = 0
		    protocol = "-1"
		+   cidr_blocks = ["0.0.0.0/0"]
		  }
		  
		+ resource "aws_security_group_rule" "bastion-elb-egress" {
		- resource "aws_security_group_rule" "https-api-elb" {
		+   type = "egress"
		-   type = "ingress"
		+   security_group_id = "${aws_security_group.bastion-elb-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.api-elb-privateweave-example-com.id}"
		+   from_port = 0
		-   from_port = 443
		+   to_port = 0
		-   to_port = 443
		+   protocol = "-1"
		-   protocol = "tcp"
		    cidr_blocks = ["0.0.0.0/0"]
		  }
		  
		+ resource "aws_security_group_rule" "https-api-elb-0-0-0-0--0" {
		- resource "aws_security_group_rule" "kube-proxy-api-elb" {
		    type = "ingress"
		    security_group_id = "${aws_security_group.masters-privateweave-example-com.id}"
		...
		    to_port = 443
		    protocol = "tcp"
		+   cidr_blocks = ["0.0.0.0/0"]
		  }
		  
		...
		  }
		  
		+ resource "aws_security_group_rule" "ssh-elb-to-bastion" {
		- resource "aws_security_group_rule" "ssh-external-to-bastion" {
		    type = "ingress"
		+   security_group_id = "${aws_security_group.bastions-privateweave-example-com.id}"
		-   security_group_id = "${aws_security_group.bastion-privateweave-example-com.id}"
		    source_security_group_id = "${aws_security_group.bastion-elb-privateweave-example-com.id}"
		    from_port = 22
		...
		  }
		  
		+ resource "aws_security_group_rule" "ssh-external-to-bastion-elb-0-0-0-0--0" {
		- resource "aws_security_group_rule" "ssh-external-to-bastion-elb" {
		    type = "ingress"
		    security_group_id = "${aws_security_group.bastion-elb-privateweave-example-com.id}"
		...
		  }
		  
		+ resource "aws_subnet" "us-test-1a-privateweave-example-com" {
		- resource "aws_subnet" "private-us-test-1a-privateweave-example-com" {
		    vpc_id = "${aws_vpc.privateweave-example-com.id}"
		    cidr_block = "172.20.4.0/22"
		...
		    tags = {
		      KubernetesCluster = "privateweave.example.com"
		+     Name = "us-test-1a.privateweave.example.com"
		-     Name = "private-us-test-1a.privateweave.example.com"
		    }
		  }
		...
